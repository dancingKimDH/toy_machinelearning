<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <title>Document</title>
</head>

<body>

    <div class="container mt-5">
        <h1>수술 실패 확률 계산</h1>

        <!-- Form -->
        <form id="predictionForm" class="mt-4">
            <!-- Texture Mean Input -->
            <div class="mb-3">
                <label for="hypertension" class="form-label">고혈압여부:</label>
                <input type="radio" name="hypertension" id="hypertension" value="1">
                <label for="hypertension_yes">예</label>
                <input type="radio" name="hypertension" id="hypertension" value="0">
                <label for="hypertension_no">아니오</label>

            </div>

            <!-- Perimeter Mean Input -->
            <div class="mb-3">
                <label for="gender" class="form-label">성별:</label>
                <input type="radio" name="gender" id="male" value="0" data-encoded="성별_1">
                <label for="male">남성</label>
                <input type="radio" name="gender" id="female" value="1" data-encoded="성별_2">
                <label for="female">여성</label>

            </div>

            <div class="mb-3">
                <label for="liver_status" class="form-label">신부전여부:</label>
                <input type="radio" name="liver_status" id="liver_status_yes" value="1">
                <label for="liver_status_yes">예</label>
                <input type="radio" name="liver_status" id="liver_status_no" value="0">
                <label for="liver_status_no">아니오</label>
            </div>

            <div class="mb-3">
                <label for="age_input" class="form-label">연령:</label>
                <input type="text" class="form-control" id="age_input" name="age" required>
            </div>

            <div class="mb-3">
                <label for="weight_input" class="form-label">체중:</label>
                <input type="text" class="form-control" id="weight_input" name="weight" required>
            </div>

            <div class="mb-3">
                <label for="surgery_duration_input" class="form-label">수술시간:</label>
                <input type="text" class="form-control" id="surgery_duration_input" name="surgery_duration" required>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary" id="predict">예상결과확인</button>
        </form>

        <!-- Result Display -->
        <div id="resultDisplay" class="mt-4"></div>

    </div>


</body>

<script>

    let predictObject = document.querySelector('#predict')
    predictObject.addEventListener('click', (event) => {
        event.preventDefault();
        let hypertension = document.querySelector('input[name="hypertension"]:checked').value;
        if (hypertension == 1) {
            hypertension_0 = 0;
            hypertension_1 = 1;
        } else {
            hypertension_0 = 1;
            hypertension_1 = 0;
        }

        let gender = document.querySelector('input[name="gender"]:checked').value;

        if (gender == 0) {
            gender_1 = 1;
            gender_2 = 0;
        } else {
            gender_1 = 0;
            gender_2 = 1;
        }
        let liver_status = document.querySelector('input[name="liver_status"]:checked').value;

        if (liver_status == 1) {
            liver_status_0 = 0;
            liver_status_1 = 1;
        } else {
            liver_status_0 = 1;
            liver_status_1 = 0;
        }

        let age = document.querySelector('#age_input').value;
        let weight = document.querySelector('#weight_input').value;
        let surgery_duration = document.querySelector('#surgery_duration_input').value;

        let request_dict = {
            "hypertension_0": hypertension_0,
            "hypertension_1": hypertension_1,
            "gender_1": gender_1,
            "gender_2": gender_2,
            "liver_status_0": liver_status_0,
            "liver_status_1": liver_status_1,
            "age": age,
            "weight": weight,
            "surgery_duration": surgery_duration
        };

        fetch('http://127.0.0.1:8000/api_v1/mlmodelwithregression', {

            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(request_dict)
        })

            .then(response => response.json())
            .then(data => {
                console.log(data)
                document.querySelector('#resultDisplay').innerHTML = `예상결과: ${data.result}`;

            })
            .catch(error => console.error(error))


    });

</script>


</html>